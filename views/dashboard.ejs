<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Portal - CyberState University</title>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f9fa;
        }

        /* Layout */
        .wrapper {
            display: flex;
        }

        /* Sidebar - Fixed */
        .sidebar {
            width: 260px;
            background: #fff;
            border-right: 1px solid #e9ecef;
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            display: flex;
            flex-direction: column;
            z-index: 1000;
        }

        .sidebar-brand {
            height: 70px;
            display: flex;
            align-items: center;
            padding-left: 1.5rem;
            font-weight: 700;
            font-size: 1.2rem;
            color: #0d6efd;
            border-bottom: 1px solid #f8f9fa;
        }

        .nav-menu {
            padding: 1.5rem 1rem;
            flex: 1;
        }

        .nav-link {
            color: #495057;
            padding: 0.8rem 1rem;
            margin-bottom: 0.25rem;
            border-radius: 0.5rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-link:hover {
            background-color: #e9ecef;
            color: #0d6efd;
        }

        .nav-link.active {
            background-color: #e7f1ff;
            color: #0d6efd;
        }

        .admin-link {
            color: #dc3545 !important;
            margin-top: 1rem;
            border-top: 1px solid #f1f1f1;
            padding-top: 1rem;
        }

        .admin-link:hover {
            background-color: #fef2f2 !important;
        }

        /* Main Content */
        .main-content {
            margin-left: 260px;
            width: calc(100% - 260px);
            padding: 2rem;
        }

        /* Sections */
        .course-section {
            padding-top: 70px;
            margin-top: -50px;
            /* Offset for sticky headers if needed, using simple spacing for now */
            margin-bottom: 3rem;
        }

        .section-title {
            font-weight: 700;
            color: #212529;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title i {
            color: #0d6efd;
        }

        /* Cards */
        .card {
            border: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            border-radius: 0.75rem;
            border: 1px solid #e9ecef;
        }

        /* Badges */
        .badge-grade {
            font-size: 1rem;
            padding: 0.5em 1em;
            border-radius: 0.5rem;
        }

        /* News/Forum */
        .forum-bg {
            background-color: #fff;
            padding: 2rem;
            border-radius: 1rem;
            border: 1px solid #e9ecef;
        }

        .comment-item {
            border-bottom: 1px solid #f1f1f1;
            padding: 1rem 0;
        }

        .comment-item:last-child {
            border-bottom: none;
        }
    </style>
</head>

<body>

    <div class="wrapper">
        <!-- SIDEBAR FIXED -->
        <nav class="sidebar">
            <div class="sidebar-brand">
                <i class="fa-solid fa-shield-cat me-2"></i> CyberState
            </div>
            <div class="nav-menu">
                <a href="#" class="nav-link"><i class="fa-solid fa-house"></i> Dashboard</a>
                <a href="#courses" class="nav-link"><i class="fa-solid fa-book"></i> My Courses</a>
                <a href="#schedule" class="nav-link"><i class="fa-regular fa-calendar-check"></i> Schedule</a>
                <a href="#grades" class="nav-link"><i class="fa-solid fa-chart-pie"></i> Grades Report</a>
                <a href="#news" class="nav-link"><i class="fa-regular fa-comments"></i> News & Forum</a>

                <a href="/admin/tools" class="nav-link admin-link"><i class="fa-solid fa-terminal"></i> Admin Tools</a>
            </div>
            <div class="p-3 border-top bg-light">
                <div class="d-flex align-items-center gap-2 mb-2">
                    <img src="https://ui-avatars.com/api/?name=<%= user.username %>&background=0D8ABC&color=fff"
                        class="rounded-circle" width="32">
                    <div class="small fw-bold">
                        <%= user.username %>
                    </div>
                </div>
                <a href="/logout" class="btn btn-outline-danger btn-sm w-100">Sign Out</a>
            </div>
        </nav>

        <!-- CONTENT SCROLLABLE -->
        <main class="main-content">

            <!-- HEADER -->
            <header class="d-flex justify-content-between align-items-center mb-5">
                <div>
                    <h2 class="fw-bold mb-1">Student Dashboard</h2>
                    <p class="text-muted">Academic Year 2025-2026</p>
                </div>
                <button class="btn btn-primary rounded-pill px-4"><i class="fa-solid fa-download me-2"></i>Download
                    Report</button>
            </header>

            <!-- GRADES SECTION -->
            <section id="grades" class="course-section">
                <h4 class="section-title"><i class="fa-solid fa-chart-line"></i> Academic Performance</h4>
                <div class="row g-4">
                    <div class="col-md-3">
                        <div class="card p-4 text-center h-100">
                            <div class="text-muted small fw-bold text-uppercase mb-2">Current GPA</div>
                            <h1 class="display-4 fw-bold text-primary mb-0">3.8</h1>
                            <span class="text-success small fw-bold"><i class="fa-solid fa-arrow-up"></i> Top 5%</span>
                        </div>
                    </div>
                    <!-- Mini Cards -->
                    <div class="col-md-9">
                        <div class="row g-3">
                            <div class="col-md-4">
                                <div class="card p-3 d-flex flex-row align-items-center gap-3">
                                    <div class="bg-success text-white rounded p-3"><i class="fa-brands fa-apple"></i>
                                    </div>
                                    <div>
                                        <h5 class="mb-0 fw-bold">95%</h5>
                                        <div class="small text-muted">CSS 214 (iOS)</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card p-3 d-flex flex-row align-items-center gap-3">
                                    <div class="bg-warning text-dark rounded p-3"><i
                                            class="fa-solid fa-network-wired"></i></div>
                                    <div>
                                        <h5 class="mb-0 fw-bold">90%</h5>
                                        <div class="small text-muted">CSS 312 (Net)</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card p-3 d-flex flex-row align-items-center gap-3">
                                    <div class="bg-info text-white rounded p-3"><i
                                            class="fa-solid fa-shield-halved"></i></div>
                                    <div>
                                        <h5 class="mb-0 fw-bold">80%</h5>
                                        <div class="small text-muted">CSS 361 (Sec)</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- COURSES SECTION -->
            <section id="courses" class="course-section">
                <h4 class="section-title"><i class="fa-solid fa-book"></i> Current Courses</h4>
                <div class="card overflow-hidden">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="bg-light">
                            <tr>
                                <th class="ps-4 py-3">Course Code</th>
                                <th>Subject Name</th>
                                <th>Instructor</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="ps-4 fw-bold text-secondary">CSS 214</td>
                                <td class="fw-medium">Intro to iOS Programming</td>
                                <td class="small text-muted">Steve Jobs</td>
                                <td><span
                                        class="badge bg-success-subtle text-success border border-success-subtle rounded-pill">Completed</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="ps-4 fw-bold text-secondary">CSS 312</td>
                                <td class="fw-medium">Computer Networks</td>
                                <td class="small text-muted">Vint Cerf</td>
                                <td><span
                                        class="badge bg-success-subtle text-success border border-success-subtle rounded-pill">Finalized</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="ps-4 fw-bold text-secondary">CSS 361</td>
                                <td class="fw-medium">Web Application Security</td>
                                <td class="small text-muted">Mr. Robot</td>
                                <td><span
                                        class="badge bg-primary-subtle text-primary border border-primary-subtle rounded-pill">Active</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="ps-4 fw-bold text-secondary">CSS 382</td>
                                <td class="fw-medium">Industrial Practice</td>
                                <td class="small text-muted">Elon Musk</td>
                                <td><span
                                        class="badge bg-info-subtle text-info border border-info-subtle rounded-pill">Internship</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="ps-4 fw-bold text-secondary">INF 346</td>
                                <td class="fw-medium">UX/UI Design</td>
                                <td class="small text-muted">Jony Ive</td>
                                <td><span
                                        class="badge bg-success-subtle text-success border border-success-subtle rounded-pill">Completed</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- SCHEDULE SECTION -->
            <section id="schedule" class="course-section">
                <h4 class="section-title"><i class="fa-regular fa-calendar"></i> Weekly Timetable</h4>
                <div class="card p-4">
                    <div class="table-responsive">
                        <table class="table table-bordered text-center align-middle table-sm">
                            <thead class="bg-light text-secondary small text-uppercase font-monospace">
                                <tr>
                                    <th style="width: 10%">Time</th>
                                    <th style="width: 18%">Monday</th>
                                    <th style="width: 18%">Tuesday</th>
                                    <th style="width: 18%">Wednesday</th>
                                    <th style="width: 18%">Thursday</th>
                                    <th style="width: 18%">Friday</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="text-muted small fw-bold">09:00 AM</td>
                                    <td></td>
                                    <td>
                                        <div
                                            class="p-2 bg-info-subtle text-info rounded small fw-bold border border-info-subtle">
                                            INF 346 (UX/UI)<br>Lab 202
                                        </div>
                                    </td>
                                    <td></td>
                                    <td>
                                        <div
                                            class="p-2 bg-secondary-subtle text-secondary rounded small fw-bold border border-secondary-subtle">
                                            CSS 382 (Practice)<br>Off-Campus
                                        </div>
                                    </td>
                                    <td>
                                        <div
                                            class="p-2 bg-success-subtle text-success rounded small fw-bold border border-success-subtle">
                                            CSS 312 (Networks)<br>Room 303
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-muted small fw-bold">10:00 AM</td>
                                    <td>
                                        <div
                                            class="p-2 bg-primary-subtle text-primary rounded small fw-bold border border-primary-subtle">
                                            CSS 214 (iOS)<br>Mac Lab
                                        </div>
                                    </td>
                                    <td></td>
                                    <td>
                                        <div
                                            class="p-2 bg-primary-subtle text-primary rounded small fw-bold border border-primary-subtle">
                                            CSS 214 (iOS)<br>Lecture Hall A
                                        </div>
                                    </td>
                                    <td></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td class="text-muted small fw-bold">12:00 PM</td>
                                    <td colspan="5" class="bg-light text-muted small py-1">LUNCH BREAK</td>
                                </tr>
                                <tr>
                                    <td class="text-muted small fw-bold">02:00 PM</td>
                                    <td>
                                        <div
                                            class="p-2 bg-warning-subtle text-warning rounded small fw-bold text-dark border border-warning-subtle">
                                            CSS 361 (Security)<br>Room 404
                                        </div>
                                    </td>
                                    <td></td>
                                    <td>
                                        <div
                                            class="p-2 bg-warning-subtle text-warning rounded small fw-bold text-dark border border-warning-subtle">
                                            CSS 361 (Lab)<br>Server Room
                                        </div>
                                    </td>
                                    <td>
                                        <div
                                            class="p-2 bg-info-subtle text-info rounded small fw-bold border border-info-subtle">
                                            INF 346 (Project)<br>Design Studio
                                        </div>
                                    </td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- NEWS & FORUM SECTION (XSS Vulnerability) -->
            <section id="news" class="course-section">
                <h4 class="section-title"><i class="fa-regular fa-newspaper"></i> University News & Anonymous Feedback
                </h4>

                <div class="row">
                    <div class="col-lg-8">
                        <div class="forum-bg">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h5 class="fw-bold mb-0">Student Voice</h5>
                                <span class="badge bg-danger">Unmoderated Zone</span>
                            </div>

                            <!-- XSS Form -->
                            <form action="/dashboard/comment" method="POST" class="mb-5">
                                <label class="form-label text-muted small fw-bold">LEAVE A COMMENT</label>
                                <div class="input-group">
                                    <input type="text" name="comment" class="form-control"
                                        placeholder="Type your message here..." required>
                                    <button class="btn btn-dark" type="submit"><i
                                            class="fa-solid fa-paper-plane me-2"></i>Send</button>
                                </div>
                            </form>

                            <!-- XSS Output -->
                            <div class="comments-list">
                                <h6 class="text-muted border-bottom pb-2 mb-3">Recent Comments</h6>

                                <% if (comments.length> 0) { %>
                                    <% [...comments].reverse().forEach(comment=> { %>
                                        <div class="comment-item">
                                            <div class="d-flex align-items-center gap-2 mb-1">
                                                <span class="badge bg-light text-dark border text-uppercase"
                                                    style="font-size: 10px;">
                                                    <%= comment.author %>
                                                </span>
                                                <small class="text-muted" style="font-size: 10px;">Just now</small>
                                            </div>
                                            <div class="ms-1">
                                                <!-- VULNERABILITY IS HERE -->
                                                <%- comment.text %>
                                            </div>
                                        </div>
                                        <% }); %>
                                            <% } else { %>
                                                <p class="text-muted small">No comments yet.</p>
                                                <% } %>
                            </div>

                        </div>
                    </div>

                    <div class="col-lg-4">
                        <div class="card p-3 bg-primary text-white h-100">
                            <h5 class="fw-bold"><i class="fa-solid fa-bullhorn me-2"></i>Announcements</h5>
                            <ul class="list-unstyled mt-3 d-flex flex-column gap-3">
                                <li class="d-flex gap-2">
                                    <i class="fa-solid fa-circle-exclamation mt-1"></i>
                                    <span class="small">Exam Registration deadline is approaching next Friday.</span>
                                </li>
                                <li class="d-flex gap-2">
                                    <i class="fa-solid fa-wifi mt-1"></i>
                                    <span class="small">Campus Wi-Fi maintenance scheduled for Sunday 2 AM.</span>
                                </li>
                                <li class="d-flex gap-2">
                                    <i class="fa-solid fa-trophy mt-1"></i>
                                    <span class="small">CTF Team selection starts tomorrow in Room 101.</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- FOOTER -->
            <footer class="mt-5 pt-5 pb-3 border-top text-center text-muted small">
                &copy; 2025 CyberState University. All Rights Reserved. <br>
                Secure Portal v4.0.1
            </footer>

        </main>
    </div>

</body>

</html>